koreats

나는 아래  내용과 '/Users/koreats/Desktop/work.mac/hiko0707/docs/supabase-migration-master-plan.md'을 합쳐서 '/Users/koreats/Desktop/work.mac/hiko0707/docs/supabase-migration-master-plan.md'를 업데이트 할 예정인데 정확한 현재 프로젝트 상태를 확인해서 사실 근거를 기반으로 '/Users/koreats/Desktop/work.mac/hiko0707/docs/supabase-migration-master-plan.md'를 업데이트 하고 싶어. 서로 내용을 비교하고 현재 프로젝트 현황을 꼼꼼하게 검토해서 어떻게 '/Users/koreats/Desktop/work.mac/hiko0707/docs/supabase-migration-master-plan.md'를 업데이트 할지 계획을 세워줘. --- 🔍 Supabase 마이그레이션 검토 보고서 (업데이트)

  📊 검토 결과 요약

  3가지 관점에서 Supabase 마이그레이션 상태를 분석한 결과, 약 75%의 마이그레이션이 완료되었으며, 몇
  가지 중요한 불일치와 미연결 요소들이 발견되었습니다.

  ---
  1️⃣ Supabase → 프로젝트 스키마 매핑 분석

  ✅ 잘 연결된 테이블 (13/18)

  - users → User 타입 + supabase-user-service.ts
  - user_addresses → supabase-address-service.ts
  - user_profiles → supabase-profile-service.ts
  - hot_deals → HotDeal 타입 + supabase-hotdeal-service.ts
  - hotdeal_translations → Translation 타입 + supabase-translation-service.ts
  - hot_deal_comments → supabase-comment-service.ts
  - user_favorite_hotdeals → supabase-favorite-service.ts
  - hot_deal_likes → supabase-like-service.ts
  - payments → Payment 타입 + supabase-payment-service.ts
  - proxy_purchases_request → BuyForMeRequest 타입
  - system_settings → supabase-system-settings-service.ts
  - admin_activity_logs → supabase-admin-log-service.ts
  - notifications → supabase-notification-service.ts

  ❌ 미연결 Supabase 테이블 (5/18)

  1. proxy_purchase_addresses - BuyForMe의 배송 주소 분리 테이블
  2. proxy_purchase_quotes - BuyForMe의 견적 관리 테이블
  3. order_status_history - 주문 상태 변경 이력
  4. comment_likes - 댓글 좋아요 기능
  5. crawling_logs - 크롤링 로그 관리

  ---
  2️⃣ 프로젝트 스키마 → Supabase 매핑 분석

  ⚠️ 구조 불일치 문제

  1. Order 타입 불일치
    - 프로젝트: Order, OrderItem[], ShippingAddress 구조
    - Supabase: proxy_purchases_request로 단순화
    - 문제점: OrderItem 배열이 JSONB로 저장되어 정규화 위반
  2. Payment 타입 불일치
    - 프로젝트: 복잡한 PaymentRequest, PaymentMethod 구조
    - Supabase: 단순화된 payments 테이블
    - 문제점: 결제 프로세스 세부 정보 누락

  ❌ Supabase에 없는 프로젝트 기능

  - Posts (커뮤니티 게시판) - LocalStorage에만 존재
  - 일반 Orders - proxy_purchases와 다른 용도

  ---
  3️⃣ LocalStorage → Supabase 마이그레이션 상태

  ✅ 완전 마이그레이션 (100%)

  - 사용자 인증 시스템
  - 사용자 프로필 관리
  - 핫딜 목록 및 상세
  - 다국어 번역 시스템
  - 즐겨찾기 기능
  - 시스템 설정

  ⚠️ 부분 마이그레이션 (50-80%)

  - BuyForMe (80%) - 연관 테이블 미완성
  - Payment (60%) - 기본 구조만 구현
  - Comments (70%) - 핫딜 댓글만 구현

  ❌ 미마이그레이션 (0%)

  - Community Posts - 커뮤니티 게시판
  - General Orders - 일반 주문 시스템

  ---
  💡 주요 의사결정 필요 사항 (Master Plan 문서 기반 업데이트)

  1. Community Posts: ❌ Phase 6 제거됨
    - 결정: Supabase에 posts 관련 테이블 없음 확인
    - 영향: 프로젝트 시간 15시간 단축
    - 대안: 관리자 핫딜 CRUD로 대체 (Phase 6으로 재구성)
  2. Order System: ⚠️ proxy_purchases 확장 사용
    - 결정: proxy_purchases_request 테이블을 일반 주문에도 활용
    - 근거: 새 테이블 생성 불가 (Supabase MCP 읽기 전용)
    - 구현: product_info JSONB 필드를 활용한 유연한 구조
  3. Payment Integration: ✅ 외부 결제 서비스 연동 확정
    - 결정: Phase 7에서 결제 게이트웨이 통합
    - 구현: payments 테이블 + 외부 서비스 webhook 처리
    - 서비스: 토스페이먼츠, 카카오페이 등 한국 결제 서비스

  ---
  📋 마이그레이션 완료 계획 (Master Plan 반영)

  즉시 시작 작업 (7시간)

  // 1. database.types.ts 생성 (1시간)
  pnpm gen:types

  // 2. buy-for-me-modal Supabase 연동 (2시간)
  - LocalStorage → SupabaseOrderService 전환
  - proxy_purchases_request 테이블 직접 연동

  // 3. comment_likes 연동 (2시간)
  - UI는 이미 구현됨
  - LocalStorage → Supabase comment_likes 테이블 전환

  // 4. Phase 1 접근성 개선 (2시간)
  - ARIA 레이블 추가
  - 모바일 최적화

  Phase 5: Hot Deals 시스템 (30시간)

  - 크롤러 시스템 정리 (supabase-crawler-service.ts 활용)
  - 중복 크롤러 제거
  - E2E 테스트 구현

  Phase 6: 관리자 기능 (13시간) - Posts 대체

  - 관리자 핫딜 CRUD 구현
  - hotdeal_translations 테이블 활용
  - comment_likes 테이블 완전 연동

  Phase 7: Orders & Payments 통합 (20시간)

  - proxy_purchases_request 확장 활용
  - 외부 결제 서비스 연동
  - order_status_history 활용

  Phase 8: LocalStorage 완전 제거 (10시간)

  - 모든 LocalStorage 참조 제거
  - 최종 검증 및 성능 최적화

  ---
  🎯 권장 우선순위

  1. 즉시 해결 필요 (Critical) - 7시간
    - database.types.ts 생성
    - buy-for-me-modal Supabase 연동
    - comment_likes 연동
  2. 단기 해결 (High) - 30시간
    - Hot Deals 시스템 완성
    - 크롤러 시스템 정리
  3. 중기 검토 (Medium) - 33시간
    - 관리자 기능 구현
    - Order/Payment 통합
  4. 장기 계획 (Low) - 10시간
    - LocalStorage 완전 제거
    - 성능 최적화

  ---
  📊 최종 마이그레이션 예상 결과

  - Supabase 테이블 활용률: 18/18 = 100%
  - 프로젝트 스키마 매핑률: 11/11 = 100% (Post 제거)
  - LocalStorage 대체율: 18/18 = 100%
  - 총 소요 시간: 7 + 30 + 13 + 20 + 10 = 80시간 (10일)
